{"ast":null,"code":"function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  subClass.__proto__ = superClass;\n}\n\nvar isArray = require('@antv/util/lib/type/is-array');\n\nvar isNil = require('@antv/util/lib/type/is-nil');\n\nvar Adjust = require('./base');\n\nvar Stack =\n/*#__PURE__*/\nfunction (_Adjust) {\n  _inheritsLoose(Stack, _Adjust);\n\n  function Stack() {\n    return _Adjust.apply(this, arguments) || this;\n  }\n\n  var _proto = Stack.prototype;\n\n  _proto._initDefaultCfg = function _initDefaultCfg() {\n    this.xField = null; // 调整对应的 x 方向对应的字段名称\n\n    this.yField = null; // 调整对应的 y 方向对应的字段名称\n  };\n\n  _proto.processAdjust = function processAdjust(dataArray) {\n    this.processStack(dataArray);\n  };\n\n  _proto.processStack = function processStack(dataArray) {\n    var self = this;\n    var xField = self.xField;\n    var yField = self.yField;\n    var count = dataArray.length;\n    var stackCache = {\n      positive: {},\n      negative: {}\n    }; // 层叠顺序翻转\n\n    if (self.reverseOrder) {\n      dataArray = dataArray.slice(0).reverse();\n    }\n\n    for (var i = 0; i < count; i++) {\n      var data = dataArray[i];\n\n      for (var j = 0, len = data.length; j < len; j++) {\n        var item = data[j];\n        var x = item[xField] || 0;\n        var y = item[yField];\n        var xkey = x.toString();\n        y = isArray(y) ? y[1] : y;\n\n        if (!isNil(y)) {\n          var direction = y >= 0 ? 'positive' : 'negative';\n\n          if (!stackCache[direction][xkey]) {\n            stackCache[direction][xkey] = 0;\n          }\n\n          item[yField] = [stackCache[direction][xkey], y + stackCache[direction][xkey]];\n          stackCache[direction][xkey] += y;\n        }\n      }\n    }\n  };\n\n  return Stack;\n}(Adjust);\n\nAdjust.Stack = Stack;\nmodule.exports = Stack;","map":{"version":3,"sources":["/home/sunxuming/react-typescript/node_modules/_@antv_adjust@0.1.1@@antv/adjust/lib/stack.js"],"names":["_inheritsLoose","subClass","superClass","prototype","Object","create","constructor","__proto__","isArray","require","isNil","Adjust","Stack","_Adjust","apply","arguments","_proto","_initDefaultCfg","xField","yField","processAdjust","dataArray","processStack","self","count","length","stackCache","positive","negative","reverseOrder","slice","reverse","i","data","j","len","item","x","y","xkey","toString","direction","module","exports"],"mappings":"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","sourcesContent":["function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }\n\nvar isArray = require('@antv/util/lib/type/is-array');\n\nvar isNil = require('@antv/util/lib/type/is-nil');\n\nvar Adjust = require('./base');\n\nvar Stack =\n/*#__PURE__*/\nfunction (_Adjust) {\n  _inheritsLoose(Stack, _Adjust);\n\n  function Stack() {\n    return _Adjust.apply(this, arguments) || this;\n  }\n\n  var _proto = Stack.prototype;\n\n  _proto._initDefaultCfg = function _initDefaultCfg() {\n    this.xField = null; // 调整对应的 x 方向对应的字段名称\n\n    this.yField = null; // 调整对应的 y 方向对应的字段名称\n  };\n\n  _proto.processAdjust = function processAdjust(dataArray) {\n    this.processStack(dataArray);\n  };\n\n  _proto.processStack = function processStack(dataArray) {\n    var self = this;\n    var xField = self.xField;\n    var yField = self.yField;\n    var count = dataArray.length;\n    var stackCache = {\n      positive: {},\n      negative: {}\n    }; // 层叠顺序翻转\n\n    if (self.reverseOrder) {\n      dataArray = dataArray.slice(0).reverse();\n    }\n\n    for (var i = 0; i < count; i++) {\n      var data = dataArray[i];\n\n      for (var j = 0, len = data.length; j < len; j++) {\n        var item = data[j];\n        var x = item[xField] || 0;\n        var y = item[yField];\n        var xkey = x.toString();\n        y = isArray(y) ? y[1] : y;\n\n        if (!isNil(y)) {\n          var direction = y >= 0 ? 'positive' : 'negative';\n\n          if (!stackCache[direction][xkey]) {\n            stackCache[direction][xkey] = 0;\n          }\n\n          item[yField] = [stackCache[direction][xkey], y + stackCache[direction][xkey]];\n          stackCache[direction][xkey] += y;\n        }\n      }\n    }\n  };\n\n  return Stack;\n}(Adjust);\n\nAdjust.Stack = Stack;\nmodule.exports = Stack;"]},"metadata":{},"sourceType":"script"}