{"ast":null,"code":"/**\n * Utility\n * @author sima.zhang1990@gmail.com\n */\nconst {\n  Matrix\n} = require('../graphic/index');\n\nconst Util = require('../util/common');\n\nconst Helpers = {\n  getCoordInfo(coord) {\n    const start = coord.start;\n    const end = coord.end;\n    return {\n      start,\n      end,\n      width: end.x - start.x,\n      height: Math.abs(end.y - start.y)\n    };\n  },\n\n  getScaledMatrix(shape, v, direct) {\n    let scaledMatrix;\n    shape.apply(v);\n    const x = v[0];\n    const y = v[1];\n\n    if (direct === 'x') {\n      shape.transform([['t', x, y], ['s', 0.01, 1], ['t', -x, -y]]);\n      const matrix = shape.getMatrix();\n      scaledMatrix = Matrix.transform(matrix, [['t', x, y], ['s', 100, 1], ['t', -x, -y]]);\n    } else if (direct === 'y') {\n      shape.transform([['t', x, y], ['s', 1, 0.01], ['t', -x, -y]]);\n      const matrix = shape.getMatrix();\n      scaledMatrix = Matrix.transform(matrix, [['t', x, y], ['s', 1, 100], ['t', -x, -y]]);\n    } else if (direct === 'xy') {\n      shape.transform([['t', x, y], ['s', 0.01, 0.01], ['t', -x, -y]]);\n      const matrix = shape.getMatrix();\n      scaledMatrix = Matrix.transform(matrix, [['t', x, y], ['s', 100, 100], ['t', -x, -y]]);\n    }\n\n    return scaledMatrix;\n  },\n\n  getAnimateParam(animateCfg, index, id) {\n    const result = {};\n\n    if (animateCfg.delay) {\n      result.delay = Util.isFunction(animateCfg.delay) ? animateCfg.delay(index, id) : animateCfg.delay;\n    }\n\n    result.easing = animateCfg.easing;\n    result.duration = animateCfg.duration;\n    result.delay = animateCfg.delay;\n    return result;\n  },\n\n  doAnimation(shape, endState, animateCfg, callback) {\n    const id = shape._id;\n    const index = shape.get('index');\n    const {\n      easing,\n      delay,\n      duration\n    } = Helpers.getAnimateParam(animateCfg, index, id);\n    const anim = shape.animate().to({\n      attrs: endState,\n      duration,\n      delay,\n      easing\n    });\n\n    if (callback) {\n      anim.onEnd(() => {\n        callback();\n      });\n    }\n  }\n\n};\nmodule.exports = Helpers;","map":{"version":3,"sources":["/home/sunxuming/react-typescript/node_modules/_@antv_f2@3.6.0-alpha.2@@antv/f2/src/animation/util.js"],"names":["Matrix","require","Util","Helpers","getCoordInfo","coord","start","end","width","x","height","Math","abs","y","getScaledMatrix","shape","v","direct","scaledMatrix","apply","transform","matrix","getMatrix","getAnimateParam","animateCfg","index","id","result","delay","isFunction","easing","duration","doAnimation","endState","callback","_id","get","anim","animate","to","attrs","onEnd","module","exports"],"mappings":"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","sourcesContent":["/**\n * Utility\n * @author sima.zhang1990@gmail.com\n */\nconst { Matrix } = require('../graphic/index');\nconst Util = require('../util/common');\n\nconst Helpers = {\n  getCoordInfo(coord) {\n    const start = coord.start;\n    const end = coord.end;\n    return {\n      start,\n      end,\n      width: end.x - start.x,\n      height: Math.abs(end.y - start.y)\n    };\n  },\n  getScaledMatrix(shape, v, direct) {\n    let scaledMatrix;\n\n    shape.apply(v);\n    const x = v[0];\n    const y = v[1];\n\n    if (direct === 'x') {\n      shape.transform([\n        [ 't', x, y ],\n        [ 's', 0.01, 1 ],\n        [ 't', -x, -y ]\n      ]);\n      const matrix = shape.getMatrix();\n      scaledMatrix = Matrix.transform(matrix, [\n        [ 't', x, y ],\n        [ 's', 100, 1 ],\n        [ 't', -x, -y ]\n      ]);\n    } else if (direct === 'y') {\n      shape.transform([\n        [ 't', x, y ],\n        [ 's', 1, 0.01 ],\n        [ 't', -x, -y ]\n      ]);\n      const matrix = shape.getMatrix();\n      scaledMatrix = Matrix.transform(matrix, [\n        [ 't', x, y ],\n        [ 's', 1, 100 ],\n        [ 't', -x, -y ]\n      ]);\n    } else if (direct === 'xy') {\n      shape.transform([\n        [ 't', x, y ],\n        [ 's', 0.01, 0.01 ],\n        [ 't', -x, -y ]\n      ]);\n      const matrix = shape.getMatrix();\n      scaledMatrix = Matrix.transform(matrix, [\n        [ 't', x, y ],\n        [ 's', 100, 100 ],\n        [ 't', -x, -y ]\n      ]);\n    }\n    return scaledMatrix;\n  },\n  getAnimateParam(animateCfg, index, id) {\n    const result = {};\n    if (animateCfg.delay) {\n      result.delay = Util.isFunction(animateCfg.delay) ? animateCfg.delay(index, id) : animateCfg.delay;\n    }\n    result.easing = animateCfg.easing;\n    result.duration = animateCfg.duration;\n    result.delay = animateCfg.delay;\n    return result;\n  },\n  doAnimation(shape, endState, animateCfg, callback) {\n    const id = shape._id;\n    const index = shape.get('index');\n    const { easing, delay, duration } = Helpers.getAnimateParam(animateCfg, index, id);\n    const anim = shape.animate().to({\n      attrs: endState,\n      duration,\n      delay,\n      easing\n    });\n\n    if (callback) {\n      anim.onEnd(() => {\n        callback();\n      });\n    }\n  }\n};\n\nmodule.exports = Helpers;\n"]},"metadata":{},"sourceType":"script"}